## Chain Of Responsibility pattern

<br>

### 책임 연쇄 패턴

> 클라이언트로부터의 요청을 처리할 수 있는 처리객체를 집합(Chain)으로 만들어 부여함으로 결합을 느슨하기 위해 만들어진 디자인 패턴이다.

- 요청을 보내는 쪽과 요청을 처리하는 쪽을 분리하는 패턴으로 핸들러 체인을 이용해 요청을 처리한다.

응답을 해야하는 핸들러는 그대로 두고 응답을 위한 처리를 하는 핸들러 체인들을 만들어 내부적으로 동작하게 하여 클라이언트 입장에서는
기존의 핸들러 타입만 알아도 되며 기존 핸들러의 변경도 발생하지 않게 한다.


<br>

**언제씀**

- 요청객체와 처리객체를 분리하거나 요청을 처리할 수 있는 객체가 여러개인데 하나의 객체에 요청을 보낼 떄 적용가능


**장점**

- 클라이언트 입장에서는 처리 내부 구조를 알 필요 없음
- 클라이언트 코드 변경 없이 새로운 핸들러를 추가하거나 순서를 변경할 수 있어 유연함
- 핸들러 하나는 본인이 맡은 역할만 관장하는 구조가 된다.


<br>

**구조**

![image](https://user-images.githubusercontent.com/76927397/187177742-5a82a148-4ed9-4fe0-9308-22f89cf7e661.png)


`Concrete Handler` 를 통해 실제로 처리해야 하는 동작을 구현한다.
`Handler` 는 요청을 받아 처리 콘크리트 핸들러들에 이를 전달하는 추상타입이다.


<br>


![image](https://user-images.githubusercontent.com/76927397/187181630-8d36027d-8d67-42c9-ba61-f489927b213b.png)


회원가입을 예시로 만들었다.

사용자 회원가입 요청에 대해 내부적으로 프로그램은 빡빡이인지, 비밀번호가 유효한지를 검증 후 회원가입 성공 응답을 해준다.

핸들러 체인으로 적절한 순서로 핸들러들을 초기화하고 이를 클라이언트가 컨트롤러를 통해 주입해 사용할 수 있다.

클라이언트 입장에서는 `SignupHandler` 라는 인터페이스만을 알고 사용하여 회원가입 요청을 하고 적절한 결과를 얻을 수 있다.


<br>


### 자바, 스프링에선

**서블릿 필터 구조**

서블릿 컨테이너로 들어오는 요청을 필터링하는데 서블릿 까지 가기 전 어떤 동작을 관장한다.

필터체인이 존재하고 `doFilter` 를 이용해 다음 핸들러(필터)로 이동시켜 또다른 동작을 처리시킨다.


**Spring SecurityConfig**

- WebSecurityConfigurerAdapter를 통해 필터체인을 형성한다고도 볼 수 있음

이미 필터체인이 형태에 맞게 형성되어있으며 어떻게 사용할 것인가에 따라 필터 체인을 커스터마이징함

![image](https://user-images.githubusercontent.com/76927397/187183727-3aee97fa-01d4-406d-96ff-9a945ed68fdd.png)


